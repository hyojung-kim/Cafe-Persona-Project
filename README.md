# 프로젝트 : Bean Spot ERD

<img width="1239" height="795" alt="전체 ERD" src="https://github.com/user-attachments/assets/0c0b4557-b17d-4e00-8b45-2a2e651ff067" />




``` ## 패키지 요약본 
=== JAVA (com.team.cafe) ===
# 백엔드 비즈니스 로직과 엔티티, 서비스, 컨트롤러 등이 들어있는 패키지 구조
cafe/
├── DB/              # SQL 스크립트 및 더미 데이터
├── Find/            # 계정 찾기(아이디/비밀번호) 관련 컨트롤러·서비스
├── Menu/            # 카페 메뉴 도메인 및 CRUD
├── Root/            # 메인 페이지 컨트롤러·서비스·뷰모델
├── bookmark/        # 즐겨찾기/좋아요 파사드 및 도메인
├── businessuser/    # 사업자 회원 도메인, 컨트롤러, 서비스
├── cafeListImg/     # 카페 이미지 업로드/조회 도메인
├── config_js/       # 글로벌 설정(WebMvc, WebClient, ExceptionHandler 등)
├── google/          # 구글 Places API 클라이언트 및 수집 로직
├── kakaosj/         # 카카오 API 연동(지도/검색 등)
├── keyword/         # 키워드(페르소나 태그) 도메인·서비스
├── like/            # 좋아요 도메인·서비스
├── list/            # 카페 목록 검색/조회 컨트롤러·서비스
├── review/          # 리뷰 도메인, 컨트롤러, 서비스, 외부 API 연동 (카카오 MAP 위치인증)
├── signup/          # 회원가입 컨트롤러·서비스
├── test/            # 테스트 컨트롤러/레포
└── user/            # 사용자(SiteUser) 도메인, 보안/인증 서비스


=== RESOURCES/templates ===
# Thymeleaf 템플릿 뷰 파일들 (페이지별 UI 구성)
templates/
├── cafe/        # 카페 상세·목록 페이지
├── fragments/   # 공통 프래그먼트(알림창 등)
├── login/       # 로그인·비밀번호 찾기 템플릿
├── mypage/      # 마이페이지(계정, 카페관리, 북마크)
├── review/      # 리뷰 CRUD 관련 페이지
└── signup/      # 일반/사업자 회원가입 템플릿


=== RESOURCES/static ===
# 정적 리소스 (CSS/JS/이미지). 프론트엔드 스타일과 스크립트
static/
├── css/     # 각 페이지별 스타일
├── js/      # 각 페이지별 동작 스크립트
└── images/  # 배너/아이콘/업로드 이미지
```








# 카페 프로젝트 요구사항서 

> 목적: 사용자의 취향/상황(페르소나·태그)에 맞춰 카페를 탐색·비교·저장·리뷰할 수 있는 웹 서비스 구축. Spring Boot + JPA + Thymeleaf + MariaDB를 기반으로 MVP를 완성하고, 이후 고도화를 위한 기준 문서로 활용한다.

---

## 1) 프로젝트 개요

* **제품명**: Bean spot Project
* **핵심 가치**: 상황·취향 맞춤 카페 탐색(태그 AND 검색), 신뢰 가능한 리뷰·이미지, 북마크/좋아요 저장
* **플랫폼**: Web(SSR: Thymeleaf)
* **기술 스택**: Spring Boot, Spring Security, JPA(Hibernate), MariaDB/MySQL, Thymeleaf, jQuery(선택), Bootstrap/Tailwind(선택)

---

## 2) 사용자 및 페르소나

* **커플/데이트**: 분위기·사진 포인트·조용함, 루프탑/야경 등
* **가족(아이 동반)**: 키즈존/주차/유아 메뉴
* **공부/작업**: 콘센트/와이파이/조용함/장시간
* **여성 이용자**: 디저트·라떼아트·포토존·건강 메뉴
* **남성 이용자**: 커피 전문성·브런치·테라스·드라이브 동선
* **풍경/여행**: 루프탑/시골뷰/드라이브 코스
* **기타**: 반려동물 동반, 심야 영업, 비건, 전시/공연, 팝업


---

## 3) 범위(Scope)

### MVP 포함(Must)

* 회원가입/로그인/로그아웃(세션) SMTP 메일인증 기반 아이디,비밀번호 찾기)
* 카페 목록/검색/필터(태그·주차·영업중)
* 카페 상세(이미지, 기본정보, 영업시간, 위치, 평균평점, 리뷰 수, 좋아요/북마크 수)
* 리뷰 CRUD, 리뷰 이미지 업로드(대표 지정/정렬)
* 좋아요/북마크 토글 + 수 집계
* 키워드/태그 관리 및 필터링(유형별 그룹)
* 카드 리스트 성능 최적화(배치 API로 이미지/좋아요/평점/북마크 묶음)
* 소셜 로그인(카카오, 구글)
* 맵 위치인증 기반 리뷰작성
* 구글Place Api 카페초기 데이터 작성 (카페명, 주소 등)
* 사업자/관리자 화면(카페 정보/메뉴 관리
* 카카오 api 기반 도로명/지번 주소검색

### 차기 포함(Should)

* 리뷰 신고/처리(Report)
* 사용자 성향 테스트



---

## 4) 기능 요구사항

### 4.1 인증/사용자

* 이메일/닉네임/비밀번호 기반 가입, 비밀번호 재설정(토큰)
* 로그인 없이도 목록/상세/검색 가능, **리뷰/좋아요/북마크는 로그인 필요**
* 권한: `ROLE_USER`, `ROLE_BUSINESS`, `ROLE_ADMIN`
* 메일인증 기반 아이디찾기 / 비밀번호찾기
* 구글/카카오 소셜로그인
  
### 4.2 카페 목록/검색/필터

* 파라미터: `kw, page, size, sort, dir, parking(Boolean), openNow(Boolean), keyList(List<Long>)`
* 정렬: 최신순(default), 이름순, 인기순

* **영업 중 판정 로직**

  * 일반 케이스: `openTime <= closeTime` → `open ≤ now ≤ close`
  * 야간영업(자정 넘김): `openTime > closeTime` → `now ≥ open` OR `now ≤ close`
* 결과 카드에는: 대표 이미지, 카페명, 주소(도시/구/상세), 영업시간, 평점 평균, 좋아요/북마크 수
  
* **배치 통계 API**로 카드에 필요한 값 일괄 조회(IDs), 쿼리복잡도 줄이고 서버 효율 증가

### 4.3 카페 상세

* 기본정보 + 소개글 + 위치 + 영업시간 + 태그(칩)
* 카페 이미지 갤러리(대표/정렬), 좋아요/북마크 토글 상태, 평균 평점/리뷰 수
* 리뷰 리스트(최근순/평점순), 메뉴 목록
* 주소데이터 기반 맵 위치 표시
  

### 4.4 좋아요 & 북마크

* 개념 분리: `CafeLike` / `Bookmark` 별도 조인 엔티티
* 유니크: `(user_id, cafe_id)` 중복 불가
* 토글 응답: `{ liked/bookmarked, count }`
* **정책 옵션**: 좋아요 성공 시 자동 북마크 생성(서비스에서 `ensureExists`)

### 4.5 리뷰/이미지/신고

* 리뷰: 평점(1\~5), 본문(TEXT), 작성·수정·삭제(작성자/관리자)
* 리뷰이미지: `multipart/form-data` 업로드, 대표 1개 보장, 정렬
* 리뷰신고(차기): 사유(enum), 상세, 처리상태(PENDING/APPROVED/REJECTED)
* 작성 전제 조건: 위치인증(Location Verification) 완료 사용자만 작성 가능

### 4.6 키워드/태그

* `KeywordType`(페르소나/공간특성/메뉴특성 등)
* `CafeKeyword`로 카페-키워드 연결(중복 방지)
* **검색 로직**: 다중 태그 AND 방식 구현

(차기사항)
→ 미존재시 태그 매칭 fallback → 인기순/이름순 정렬

ex) 3개의 키워드 선택
사용자 선택 태그: [데이트, 루프탑, 디저트]

1차: AND 검색(3/3 매칭) - (1차)

세 태그를 모두 가진 카페만 노출.

결과가 0개면 2차: 완화 검색(2/3 매칭)

세 태그 중 적어도 2개를 가진 카페를 노출.

### 4.7 사업자/관리자

* 카페 정보/메뉴/이미지 관리(BUSINESS)
  기본: 카페명, 소개문, 전화번호, 영업시간, 메뉴 등
* 대상 권한: ROLE_BUSINESS 이상만 이용가능
* 사업장 주소 등록 시 카카오(다음) 우편번호 서비스 기반 검색 제공
  

### 4.8 차기 사항 (Should)
* 리뷰 신고/처리(ADMIN)
* 사용자 성향 테스트

---

## 5) 비기능 요구사항(NFR)


* **보안**: 비밀번호 해시(BCrypt), CSRF 방어, 인증 필요 API 보호, 파일 업로드 확장자

---


## 6) 화면/UX 요구사항

* **공통 테마**: 따뜻하고 미니멀한 카페 톤, 라운드·은은한 그림자, 칩 컴포넌트
* **목록**: 4×3 카드 그리드(데스크톱), 반응형(모바일 2열)
* **검색바/필터**: 상단 고정, 체크 시 선택 칩 노출, 초기화 버튼
* **상세**: 헤더(대표 이미지/기본정보/토글), 탭(정보/리뷰/사진)
* **접근성/피드백**: 토글/업로드 시 스낵바/아이콘 상태 전환

---

## 7) 정책/규칙

* 리뷰 평점: 1\~5 정수(서버 검증)
* 좋아요·북마크: 사용자당 카페 1개만(UNIQUE)
* 리뷰: (정책 선택) 사용자당 카페 다수, 다수 허용 시 수정 이력 보관 고려
* 이미지: 한 리뷰에 대표 1개 보장(서비스 or DB 제약)
* 검색 태그: 태그 다중 선택 검색, 미존재 시 조건완화
* 조회수(views) 상세 페이지 렌더링 시 1회 처리
	로그인 사용자: (userId, cafeId) 기준 12시간 내 재방문은 미측정
	비로그인 사용자: (clientId 쿠키, cafeId) 기준 12시간 내 미측정.
    첫 방문 시     clientId 발급(1년 만료)


---


## 8) 테스트 기준

### 8.1 카페 목록 검색

* [ ] `kw`가 이름/주소/도시에 부분 일치하면 노출된다
* [ ] `parking=true`면 주차 가능한 카페만 노출된다
* [ ] `openNow=true`면 현재 영업 중인 카페만 노출된다(자정 넘김 케이스 포함)
* [ ] `keyList` 선택 갯수만큼 AND 매칭, 현재 완화조건 없음

### 8.2 좋아요/북마크 토글

* [ ] 로그인하지 않으면 401/리다이렉트 처리한다
* [ ] 최초 클릭 시 생성되고, 재클릭 시 해제된다
* [ ] 응답에 최신 카운트가 반환된다
* [ ] 좋아요 성공 시 북마크가 보장된다

### 8.3 리뷰/이미지

* [ ] 평점 1\~5 이외면 400을 반환한다
* [ ] 작성자는 본인 리뷰만 수정/삭제할 수 있다
* [ ] 이미지 업로드는 허용 확장자/최대 용량을 초과하면 거부한다
* [ ] 대표 이미지를 변경하면 기존 대표는 자동 해제된다

---

#페이지 소개

### 1.메인페이지

<img width="1266" height="1079" alt="localhost_8080_main (5)" src="https://github.com/user-attachments/assets/83917f22-8e87-4de1-8bda-fcebadc5a8ad" />

- 배너 : 오늘 날짜기준 인기순 카페 바로가기
- 검색영역 : 카페이름으로 검색하여 이동 혹은 목록으로 바로가기
- 카페 추천 섹션 : 인기순 정렬된 카페 선택 바로가기, 카페 리뷰순 정렬 후 최신 리뷰1건씩 표시


### 2.목록페이지
<img width="1266" height="1098" alt="localhost_8080_cafe_list_" src="https://github.com/user-attachments/assets/e25296bc-dfc9-4fcc-b1b5-5147e0fb1020" />

- 상단 필터 목록 : 4가지 타입으로 분류된 테마별 키워드 태그
- 하단 필터 : 주차여부, 영업여부, 인기순 , 등록순, 이름순 등의 필터
- 목록 카드섹션 : 카페명, 영업표시, 목록별 평균 별점, 좋아요(북마크) 카운트, 조회수
- 하단 페이징 기능

### 3. 상세페이지
<img width="1266" height="1859" alt="localhost_8080_cafe_detail_71" src="https://github.com/user-attachments/assets/414c3bc4-2e51-4d81-b5c4-fbc0f35dda14" />

- 상단 카페소개 : 카페명, 평균별점, 리뷰 갯수, 조회수, 주소, 카페 핵심키워드태그, 소개문구, 영업시간, 번호, 편의시설, 웹사이트, 메뉴목록
- 카페 지도위치 : 등록된 주소 기준 지도 표시
- 하단 리뷰 목록 : 리뷰 목록 4개 , 최신순 인기순 정렬 선택, 리뷰페이지로 이동
