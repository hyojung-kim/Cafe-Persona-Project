<html layout:decorate="~{layout}">
<div layout:fragment="content">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- 카페명 + 영업상태 -->

    <span th:text="${cafe.name}">카페명</span>

    <span th:if="${openNow != null}"
              class=""
              th:classappend="${openNow} ? ' badge--open' : ' badge--closed'"
              th:text="${openNow} ? '[영업중]' : '[마감]'">영업중</span>

        <!-- 정말 빈칸으로 두고 싶으면 아래 줄을 삭제하세요 -->
    <span th:if="${openNow == null}" class="muted">영업시간 미등록</span>

    <div >
        <img th:each="img : ${cafe.images}" th:src="${img.imgUrl}" class="thumb" alt="이미지"
             style="width:150px; height:150px; object-fit:cover; border-radius:8px; margin:4px;">
    </div>


    <!-- 주소 + 영업시간 -->
    <p>
        <strong>주소:</strong>
        <span th:text="${cafe.address1}">대전 서구 둔산동 101</span>
        <span th:if="${cafe.address2}" th:text="| ${cafe.address2}|"></span>
    </p>

    <p>
        <strong>영업시간:</strong>
        <span th:if="${cafe.openTime != null and cafe.closeTime != null}"
              th:text="|${#temporals.format(cafe.openTime,'HH:mm')} ~ ${#temporals.format(cafe.closeTime,'HH:mm')}|">
          09:00 ~ 22:00
        </span>
        <span th:unless="${cafe.openTime != null and cafe.closeTime != null}" class="muted">미등록</span>
    </p>

    <p>
        <strong>주차:</strong>
        <span th:text="${cafe.parkingYn} ? '가능' : '불가'">가능</span>
    </p>

    <!-- URL 링크 -->
    <p>
        <strong>웹사이트:</strong>
        <a th:if="${cafe.siteUrl}" th:href="${cafe.siteUrl}" target="_blank" rel="noopener">바로가기</a>
        <span th:unless="${cafe.siteUrl}" class="muted">없음</span>
    </p>

    <span class="muted">조회수: <strong th:text="${cafe.hitCount}">0</strong></span>

    <div id="likeBox"
         th:data-cafe-id="${cafe.id}"
         th:data-liked="${liked}">
        <button id="likeBtn" type="button" aria-label="좋아요 토글">
            <span class="label-liked" th:if="${liked}"><i class="fa-solid fa-bookmark" id="activeBookmark"></i></span>
            <span class="label-unliked" th:if="${!liked}"><i class="fa-regular fa-bookmark" id="disableBookmarkIcon"></i></span>

        </button>
        <span style="margin-left:8px;">
            북마크 저장 : <b id="likeCount" th:text="${likeCount}">0</b>
        </span>
    </div>

    <div class="meta">
        <span>리뷰 수:
            <strong th:text="${reviewCount}">0</strong>
        </span>
        <span>평균 별점:
            <strong th:text="${#numbers.formatDecimal(avgRating, 1, 1)}">0.0</strong>
        </span>
    </div>

    <div class="chips">
        <div class="chip" th:each="k : ${detailKeyword}" th:text="${k.name}">키워드</div>
    </div>

    <!-- 없을 때 -->
    <p class="muted" th:if="${#lists.isEmpty(detailKeyword)}">등록된 키워드가 없습니다.</p>

    <script src="/js/cafe-like.js"></script>

    <!-- 하단: 리뷰 리스트 페이지로 이동 (스타일 없음) -->
    <div style="margin-top:16px;">
        <a th:href="@{/cafes/{id}/reviews(id=${cafe.id})}">리뷰 목록 보기</a>
    </div>

    <!-- mybookmark페이지에서 이동해 왔을 때 뒤로가기 버튼 생성 -->
    <div th:if="${param.from != null and param.from[0] == 'bookmark'}" style="margin-top: 16px;">
        <a th:href="@{/mypage/my/bookmark}" class="btn btn-secondary">
            내 북마크로 돌아가기
        </a>
    </div>
    <div style="margin-top:8px;">
        <a class="btn" th:href="@{/cafe/map/{cafeId}(cafeId=${cafe.id})}">카페 위치 보기</a>
    </div>
</div>
</html>